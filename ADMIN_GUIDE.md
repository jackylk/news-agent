# 管理界面使用指南

## 概述

管理界面用于管理新闻来源和数据，提供以下功能：
1. 查看所有新闻来源及其统计信息
2. 删除某个来源的所有数据
3. 手动触发刷新某个来源的数据

## 访问管理界面

### 本地开发

1. 在浏览器中打开：`http://localhost:3000/admin.html`
   - 或者如果使用 Vercel 部署前端：`https://your-vercel-domain.vercel.app/admin.html`

### 部署环境

1. 访问：`https://your-vercel-domain.vercel.app/admin.html`

## 管理员认证

### 设置管理员令牌

1. 在服务器环境变量中设置 `ADMIN_TOKEN`
   - Railway: 在项目设置中添加环境变量 `ADMIN_TOKEN=your_strong_password`
   - 本地开发: 在 `server/.env` 文件中添加 `ADMIN_TOKEN=your_strong_password`

2. **重要**: 生产环境请使用强密码，不要使用默认的 `admin123`

### 登录

1. 打开管理界面
2. 在"管理员认证"部分输入管理员令牌
3. 点击"登录"按钮

## 功能说明

### 1. 查看来源列表

登录后，会自动显示：
- **总新闻数**: 数据库中所有新闻的总数
- **来源数量**: 当前有多少个不同的新闻来源
- **最后更新**: 系统最后更新时间

来源列表表格显示：
- **来源名称**: 新闻来源的名称
- **新闻数量**: 该来源的新闻数量
- **最后更新**: 该来源最后添加新闻的时间
- **最早添加**: 该来源最早添加新闻的时间
- **最新发布日期**: 该来源最新新闻的发布日期
- **操作**: 刷新和删除按钮

### 2. 刷新来源数据

1. 在来源列表中找到要刷新的来源
2. 点击该来源行的"刷新"按钮
3. 确认操作
4. 系统会开始重新收集该来源的新闻
5. 刷新完成后，列表会自动更新

**注意**: 刷新操作是异步的，点击后会立即返回，实际收集在后台进行。

### 3. 删除来源数据

1. 在来源列表中找到要删除的来源
2. 点击该来源行的"删除"按钮
3. 确认操作（需要确认两次，防止误操作）
4. 系统会删除该来源的所有新闻数据
5. 删除完成后，列表会自动更新

**警告**: 删除操作不可恢复，请谨慎操作！

## API 接口

管理界面使用以下 API 接口：

### 获取来源列表
```
GET /api/admin/sources
Headers: X-Admin-Token: your_token
```

### 获取统计信息
```
GET /api/admin/stats
Headers: X-Admin-Token: your_token
```

### 刷新来源数据
```
POST /api/admin/source/:source/refresh
Headers: X-Admin-Token: your_token
```

### 删除来源数据
```
DELETE /api/admin/source/:source
Headers: X-Admin-Token: your_token
```

## 安全建议

1. **使用强密码**: 生产环境必须使用强密码作为 `ADMIN_TOKEN`
2. **HTTPS**: 确保管理界面通过 HTTPS 访问
3. **限制访问**: 考虑添加 IP 白名单或其他访问控制
4. **定期更换**: 定期更换管理员令牌

## 故障排查

### 问题：无法登录

- 检查 `ADMIN_TOKEN` 环境变量是否正确设置
- 确认输入的令牌与服务器环境变量中的值一致
- 检查浏览器控制台是否有错误信息

### 问题：刷新失败

- 检查来源名称是否正确
- 查看服务器日志，确认是否有错误信息
- 确认该来源的 RSS 或博客配置是否正确

### 问题：删除失败

- 检查数据库连接是否正常
- 查看服务器日志，确认是否有错误信息
- 确认来源名称是否正确

## 下一步

- 添加更多管理功能（如批量操作、数据导出等）
- 添加操作日志记录
- 添加更细粒度的权限控制
